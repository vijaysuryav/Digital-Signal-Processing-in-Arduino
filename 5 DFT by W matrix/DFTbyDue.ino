//PPG Signal with 512 samples and fs=100Hz
#include "math.h"
#define pi 3.14

const int N=512;
float x[N]={-85.92793398,-86.69150515,-86.99981705,-86.67696638,-87.48944123,-88.17579974,-87.25025058,-87.78515961,-88.85228071,-89.08611017,-88.5495826,-89.10892238,-85.94717418,-74.78380911,-54.74319702,-25.8725248,5.734844906,43.63939214,82.22163083,126.1403681,166.3581367,200.1580114,224.6567954,235.8951236,236.6350914,228.2364336,215.7517875,199.7304535,183.0526598,164.451384,147.7454344,133.1101723,117.4100513,104.0578787,92.96231302,83.64212438,75.40712253,67.38334718,59.55126509,52.05408636,46.75628136,39.07372117,31.55281913,26.52273248,21.23104094,16.83055082,14.12854006,11.78295271,10.29122133,11.56529127,12.44005856,15.89205706,16.57920481,20.82605331,24.68610638,28.83115495,32.10271178,35.26788073,38.85042821,40.15268265,41.51999661,44.21110685,44.65061207,45.22355059,44.16606717,42.48934678,40.39368377,39.38962361,37.47433837,34.36045323,30.87850385,28.89943922,24.87165161,22.73880561,17.34846792,13.28997415,9.386866317,8.585680418,4.990277392,0.210560004,-1.045616372,-2.951517078,-5.153396155,-6.691079361,-11.04887989,-10.15742605,-10.71853025,-14.18369285,-13.7489778,-14.76135737,-15.90608967,-17.91863238,-19.93896277,-20.78981069,-20.76297376,-20.66031773,-22.89629531,-22.58432932,-23.44042932,-24.42924119,-23.13540187,-15.27380852,2.924834175,29.01827719,59.32480144,93.69454459,132.5918132,175.516855,217.5598942,254.1045402,281.0784493,294.046527,295.9851732,287.9272896,274.6393558,258.9828948,241.80706,223.5785879,205.8109081,186.8535641,171.3100155,157.2273513,143.6257316,132.1879646,123.5054838,115.2825989,105.5984297,98.91636903,91.69007103,83.78981323,75.64193925,69.13223697,62.44538958,55.39894152,52.76512697,48.86275069,46.94131228,45.43562355,43.65283841,44.22241945,45.63795874,46.32245006,49.43648317,52.33619196,56.05543186,60.02768283,59.67503036,61.74282884,63.7716388,63.91190075,63.07725187,61.47118203,60.69279487,61.3300246,57.63096918,54.89533262,52.53064408,48.91322873,42.72296985,40.56941974,35.26287978,30.74345357,25.90709083,21.23590124,19.13705569,13.23259926,9.995647641,5.947470944,2.3020714,-0.273020168,-5.303390433,-8.408941295,-12.69227445,-15.47389981,-18.60678393,-19.89307831,-21.82280089,-23.35713973,-24.92317287,-27.3449389,-29.1670354,-34.0017195,-33.71521494,-34.83980033,-37.54259703,-38.70720611,-40.86754895,-42.26792043,-42.94178844,-45.17075785,-45.25747207,-40.847275,-27.94521897,-5.553348814,22.6032016,55.91258852,93.57210758,134.134401,176.2647049,213.8847838,243.9098977,262.7346578,267.1402418,261.6092627,249.3255888,231.1771514,212.3543677,194.0632847,173.2948606,155.8770834,136.8462238,120.0145792,104.7796543,92.90879055,83.3849822,73.81556036,64.56833776,53.94269933,44.86826557,36.78371015,28.71440805,21.45234109,14.54371802,7.922257347,1.948362633,-1.762266822,-5.988168012,-8.987181546,-9.209560555,-9.347619509,-8.586004739,-6.911761095,-5.586692166,-3.47774504,-2.325272212,-0.825861468,0.381614533,2.72002706,3.444811327,3.459860825,3.743980827,1.120875587,-0.893490159,-1.73794242,-5.240308761,-6.991272862,-12.17338278,-14.76958766,-20.70318785,-22.34324667,-28.10136805,-32.04357897,-37.91965191,-41.19194997,-46.47893072,-51.00025441,-55.88427686,-60.08788268,-64.40105651,-68.49294789,-72.95700089,-77.58332936,-81.32232679,-84.74982347,-88.16207018,-90.29003016,-93.00654514,-94.85280402,-97.90151909,-99.96560941,-102.281226,-104.730304,-107.5433184,-108.736526,-110.3919101,-112.994125,-114.5932691,-115.6691878,-116.6635009,-118.4563797,-120.5252661,-121.7613188,-121.5500133,-113.3721993,-95.18637001,-69.10695077,-38.45098734,-3.8139803,35.92972844,78.35112817,118.4583904,154.4623887,177.5332104,187.3782538,185.1194861,175.5769386,159.6775924,141.2468666,121.207855,100.3746616,80.27151015,63.09047029,46.28897251,30.58813908,18.17981159,7.782219036,-4.885849039,-14.16494878,-23.83557831,-31.62144891,-40.34592519,-48.08045579,-57.31471654,-62.80312444,-70.31069848,-74.4699931,-79.78629236,-82.62037293,-86.21852171,-85.82547678,-87.75706993,-86.95346598,-86.53314753,-84.78195683,-81.20792144,-78.07158845,-75.61109811,-73.56688644,-70.71523862,-70.43617642,-68.96579437,-69.15572736,-70.18574801,-71.24674322,-72.09857737,-73.81551502,-74.0525353,-76.20084933,-79.94826525,-83.88523122,-87.12931505,-91.55902322,-96.10263962,-100.9898104,-104.9089619,-109.3175015,-113.6081524,-116.4723321,-120.9082636,-123.3926842,-127.5800561,-132.1813381,-135.1756817,-137.6845523,-141.526438,-143.5864952,-146.0380855,-147.513958,-150.8935584,-151.3778043,-152.9141638,-155.4902975,-156.5566682,-159.5920098,-160.0010256,-161.7364638,-161.8679664,-162.5365669,-165.3665131,-166.5785243,-165.8285221,-167.8974731,-168.3330636,-163.2320144,-148.398729,-125.1742627,-96.50799075,-64.05947729,-27.05422261,14.50761576,57.76914974,97.16922046,125.4377531,144.9921178,149.3073115,143.4771529,130.8939138,114.7315792,96.61197801,77.69293391,59.92680519,39.6407915,23.1962204,7.451313087,-6.090043504,-16.73534433,-27.87095743,-36.93590366,-45.09723665,-53.25265143,-62.57506023,-68.48493214,-74.91118082,-83.07529306,-88.3451729,-92.71607736,-96.56480789,-99.3667883,-101.7829322,-103.2828832,-101.1301205,-99.41726244,-99.32180803,-96.16889351,-93.59439734,-90.98419173,-87.08290354,-84.75949126,-80.88355243,-76.92355311,-76.09293626,-74.1332554,-73.28426265,-72.70590543,-73.79462871,-74.12460561,-75.65813082,-76.16437476,-78.81346618,-80.20140375,-82.52359694,-85.68740112,-87.77787039,-90.90295301,-94.26567934,-96.68422417,-101.2016971,-103.2437543,-106.0942834,-109.3261912,-111.3024329,-113.3935503,-116.40338,-119.6243117,-120.3792903,-122.4211181,-124.5986906,-126.2383913,-127.2287565,-127.3648752,-129.1073067,-128.763307,-129.7916698,-130.0825754,-131.3346908,-131.1086421,-130.7054372,-132.2001492,-131.3682332,-132.1101403,-134.6568916,-132.8951818,-128.803372,-121.8958891,-102.8350551,-76.06734725,-45.17860111,-8.761665401,30.17179419,72.21951774,112.7484744,147.9904047,172.68141,183.6642646,186.5232637,177.0946798,164.2524518,150.1624909,130.8976453,114.5367575,96.30900016,79.95313509,65.44748588,51.13593028,40.05902884,28.90164204,19.87866035,11.65467713,4.203606365,-4.161358261,-11.84388766,-17.65328467,-24.49662868,-28.07438735,-33.58089918,-37.67336101,-40.05329513,-40.61387548,-42.20004745,-41.61480185,-39.0359658,-36.24899246,-34.97510621,-32.81971934,-28.44756161,-25.46470929,-21.97021979,-16.82200422,-14.86029993,-11.17631012,-7.925288611,-4.920318056};
//float x[N]={0,1,0,-1};
float w_real[N];
float w_imag[N];
float dft_real[N];
float dft_imag[N];
double dft_mag[N];
float winv_real[N];
float winv_imag[N];
float idft_real[N];
float idft_mag[N];


void setup() {
  Serial.begin(9600);
//*******************************DFT***************************************
  for(int n=0;n<N;n++)
  {
    for(int i=0;i<N;i++)
    {
      w_real[i]=cos((i*n*2*pi)/N);
      w_imag[i]=-1*sin((i*n*2*pi)/N);
    }
    for(int i=0;i<N;i++)
    {
      dft_real[n]=dft_real[n]+(x[i]*w_real[i]);
      dft_imag[n]=dft_imag[n]+(x[i]*w_imag[i]);
    }  
    dft_mag[n]=sqrt(sq(dft_real[n])+sq(dft_imag[n]));  
  }
//*******************************IDFT***************************************
  for(int n=0;n<N;n++)
  {
    for(int i=0;i<N;i++)
    {
      winv_real[i]=cos((i*n*2*pi)/N);
      winv_imag[i]=sin((i*n*2*pi)/N);
    }
    for(int i=0;i<N;i++)
    {
      idft_real[n]=idft_real[n]+(dft_real[i]*winv_real[i])-(dft_imag[i]*winv_imag[i]);
    }  
    idft_mag[n]=idft_real[n]/N;  
  }
}

void loop() {
  for(int i=0;i<N;i++)
  {
  Serial.print(x[i]*100);
  Serial.print(' ');
  Serial.print(dft_mag[i]);
  Serial.print(' ');
  Serial.println(idft_mag[i]*100);
  }

}
